<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Survey Page</title>

    <!-- Latest compiled and minified CSS & JS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  </head>

  <body>
    <div class="container">
      <div class="jumbotron">
        <h1 class="text-center">
          <span class="fa fa-fire"></span> Friend Finder
        </h1>
        <hr />
        <h2 class="text-center">Take the Survey</h2>
        <br />
        <div class="text-center">
          <a href="/survey">
            <button class="btn btn-lg btn-primary">
              <span class="fa fa-list-alt"></span>
            </button>
          </a>
          <a href="/">
            <button class="btn btn-lg btn-default">
              <span class="fa fa-home"></span>
            </button>
          </a>
        </div>
      </div>
      <br />
      <!--=================================START OF SURVEY==========================================================-->
      <div class="card">
        <div class="card-header">
          Basic Info
        </div>
        <div class="card-body">
          <form role="form" class="form">
            <div class="form-group">
              <label for="reserve-name">Name</label>
              <input type="text" class="form-control" id="friendName" />
            </div>
            <div class="form-group">
              <label for="email">Email</label>
              <input type="text" class="form-control" id="friendEmail" />
            </div>
          </form>
        </div>
      </div>
    </br>

      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-1">
            <div class="card-header">
              i like dogs
            </div>
            <div class="card-body">
              <input type="radio" name="question-1" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-1" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-1" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-1" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-1" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-2">
            <div class="card-header">
              i like bikes
            </div>
            <div class="card-body">
              <input type="radio" name="question-2" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-2" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-2" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-2" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-2" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-3">
            <div class="card-header">
              i like bikes and dogs
            </div>
            <div class="card-body">
              <input type="radio" name="question-3" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-3" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-3" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-3" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-3" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-4">
            <div class="card-header">
              i like indie-alternative-rock music
            </div>
            <div class="card-body">
              <input type="radio" name="question-4" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-4" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-4" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-4" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-4" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-5">
            <div class="card-header">
              i like to party
            </div>
            <div class="card-body">
              <input type="radio" name="question-5" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-5" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-5" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-5" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-5" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-6">
            <div class="card-header">
              i like to go on hikes
            </div>
            <div class="card-body">
              <input type="radio" name="question-6" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-6" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-6" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-6" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-6" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-7">
            <div class="card-header">
              i like to go to museums
            </div>
            <div class="card-body">
              <input type="radio" name="question-7" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-7" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-7" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-7" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-7" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-8">
            <div class="card-header">
              i play an instrument
            </div>
            <div class="card-body">
              <input type="radio" name="question-8" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-8" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-8" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-8" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-8" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-9">
            <div class="card-header">
              i think people are all inherently good
            </div>
            <div class="card-body">
              <input type="radio" name="question-9" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-9" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-9" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-9" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-9" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="questionCard-10">
            <div class="card-header">
              i like watch and/or play hockey
            </div>
            <div class="card-body">
              <input type="radio" name="question-10" value="1" /><label
                for="strongly disagree"
                >strongly disagree</label
              >
              <br />
              <input type="radio" name="question-10" value="2" /><label
                for="disagree"
                >disagree</label
              >
              <br />
              <input type="radio" name="question-10" value="3" /><label
                for="indifferent"
                >indifferent</label
              >
              <br />
              <input type="radio" name="question-10" value="4" /><label
                for="agree"
                >agree</label
              >
              <br />
              <input type="radio" name="question-10" value="5" /><label
                for="strongly agree"
                >strongly agree</label
              >
            </div>
          </div>
        </div>
      </div>
      <br />
      <!-- ----------------------------------------- submit reset button------------------------------ -->
      <div class="row">
        <div class="col-lg-12">
          <div class="card" id="button-card">
            <div class="card-body">
              <div class="text-center">
                <button class="btn btn-lg btn-primary" id="submit-btn">
                  <span class="fa">Submit</span>
                </button>
                <button class="btn btn-lg btn-default" id="reset-btn">
                  <span class="fa">Reset</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>


      <!--------------------friend match goes here---------------->
      <div class="row">
          <div class="col-lg-12">
            <div class="card" id="friendMatch" style="display: none;">
              <div class="card-header" id="friendMatchDisplayName">
              <div class="card-body" id="friendMatchDisplayImg">

              </div>
              </div>
            </div>
          </div>
      </div>


      <br />
      <footer class="footer">
        <div class="container">
          <p>
            Thanks for dropping by.
          </p>
        </div>
      </footer>
    </div>

    <script>
    
 grabRadioAnswerValues = () => {
  var allScores = [];
  var radios = $("input");
  var value;

  //looping through all radio questions to see if theyre checked and then getting the value of the checked answers and pushing them to an array
  for (var i = 0; i < radios.length; i++) {
    if (radios[i].type === "radio" && radios[i].checked) {
      // get value, set checked flag or do whatever you need to
      value = Number(radios[i].value);
      console.log(radios[i].name, "value:  ", value);
      allScores.push(value);
    }
  }
  // setting the new friends score to 0
  totalFriendScore = 0;

  //looping through all scores and adding them together to make a total score
  for (var i = 0; i < allScores.length; i++) {
    totalFriendScore += allScores[i];
  }
  console.log("totalFriendScore:  ", totalFriendScore);
}

//uncheck radios and clear form-----------
resetSurvey = () => {
  var radios = $("input");
  //loop through radios and set checked to false
  for (var i = 0; i < radios.length; i++) {
    if (radios[i].type === "radio" && radios[i].checked) {
      radios[i].checked = false;
    }
  }
  //clear form elements
  $("#friendName").val("");
  $("#friendEmail").val("");

  $("#friendMatchDisplayName").text("");
  $("#friendMatchDisplayImg").text("");

  $("#submit-btn").show();
};

//--------------validate name and email
validateName = () => {
  var isValid = true;
 $(".form-control").each(function () {
  if ($(this.val) === "") {
    isValid = false;
  }
 })
 return isValid
}


//SUBMIT BUTTON CLICK LISTENER
$("#submit-btn").on("click", function(event) {
  event.preventDefault();
  $("#submit-btn").hide();
  //getting radio inputs
  grabRadioAnswerValues();


  if (validateName()) {

  // Here we grab the form elements and make a newFriend object so we can later send it to our api
  var newFriend = {
    friendName: $("#friendName")
      .val()
      .trim(),
    friendEmail: $("#friendEmail")
      .val()
      .trim(),
    friendScore: totalFriendScore
  };

  console.log("newFriend goes here:  ", newFriend);

  //This line is the magic. It"s very similar to the standard ajax function we used.
  // Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
  // The callback is the response of the server.


  $.post("/api/friends", newFriend, function(data) {
    // If data posted render it to the page in a new area
    if (data) {
      console.log("data:  ", data)
      console.log(newFriend)
    var friendCard = document.getElementById("friendMatch");
    var name = data.friendName
    var email = data.friendEmail

    console.log("name:  ", name)

      $("#friendMatchDisplayName").append(`Friend Match:  ${name}`)
      // $("#friendMatchDisplayName").text("i am working!!!")
      $("#friendMatchDisplayImg").text(`Friend Email:  ${email}`)

      if (window.getComputedStyle(friendCard).display === "none") {
        $("#friendMatch").css("display", "block")
      } else {
        $("#friendMatch").css("display", "none")
      }

    }
    // If something happened... tell user they on the waiting list.
    else {
      alert("Sorry....maybe no friends right now....");
    }
  });
} else {
  alert("required parts of form not filled out")
}
});


//reset button------------

$("#reset-btn").on("click", function() {
  resetSurvey();
});

    </script>
  </body>
</html>
